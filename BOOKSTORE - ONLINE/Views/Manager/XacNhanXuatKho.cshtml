@model IEnumerable<BOOKSTORE___ONLINE.Models.Entities.xuatKhoInFo>

@{
    ViewBag.Title = "Xác nhận xuất kho";
    Layout = "~/Views/Shared/LayoutNhanVien.cshtml";
}

<div class="container mt-4">

    <div class="card shadow-sm">
        <div class="card-header bg-primary text-white">
            <h5 class="mb-0">
                <i class="bi bi-check2-square"></i> Xác nhận xuất kho
            </h5>
        </div>

        <div class="card-body p-0">

            <div class="table-responsive">
                <table class="table table-bordered table-hover align-middle mb-0">
                    <thead class="table-primary text-center">
                        <tr>
                            <th>Mã đơn</th>
                            <th>Nhân viên</th>
                            <th>Khách hàng</th>
                            <th>Mã sách</th>
                            <th>Số lượng xuất</th>
                            <th>Tồn kho</th>
                            <th>Giá</th>
                            <th>Tổng tiền</th>
                            <th>Trạng thái</th>
                        </tr>
                    </thead>

                    <tbody>
                        @foreach (var item in Model)
                        {
                            var duHang = item.TONKHO >= item.SOLUONG;
                            <tr class="text-center">
                                <td>@item.MADONHANG</td>
                                <td>@item.TENNHANVIEN</td>
                                <td>@item.TENKHACHHANG</td>
                                <td>@item.MASACH</td>
                                <td>
                                    <span class="badge bg-info">@item.SOLUONG</span>
                                </td>
                                <td>
                                    <span class="badge @(duHang ? "bg-success" : "bg-danger")">
                                        @item.TONKHO
                                    </span>
                                </td>
                                <td>@item.GIATAITHOIDIEMMUA.ToString("N0") ₫</td>
                                <td class="fw-bold text-danger">
                                    @item.TONGTIEN.ToString("N0") ₫
                                </td>
                                <td>
                                    @if (duHang)
                                    {
                                        <span class="badge bg-success">Đủ hàng</span>
                                    }
                                    else
                                    {
                                        <span class="badge bg-danger">Không đủ hàng</span>
                                    }
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>

        </div>

        <!-- FOOTER -->
        <div class="card-footer text-end">
            @if (Model.All(x => x.TONKHO >= x.SOLUONG))
            {
                <a href="@Url.Action("XuatKhoAction","Manager", new { id = Model.First().MADONHANG })"
                   class="btn btn-success">
                    <i class="bi bi-box-arrow-right"></i> Xác nhận xuất kho
                </a>
            }
            else
            {
                <button class="btn btn-secondary" disabled>
                    Không đủ tồn kho
                </button>
            }

            <a href="@Url.Action("formQLXK","Manager")"
               class="btn btn-outline-secondary ms-2">
                Quay lại
            </a>
        </div>

    </div>

</div>
